<html>

<head>
  <title>OAuth Implicit Flow</title>
  <meta charset="UTF-8" />
  <script src="/dist/lib.umd.min.js"></script>
</head>

<body>
  <div id="app">Loading...</div>

  <script type="text/javascript">	
    window.addEventListener('load', async () => {
      // e.g. 
      // http://localhost:3333/test/fixtures/implicit-flow?clientId=foobarIdHere
      const OAUTH_CLIENT = window.location.search.split('=')[1]

      const client = allthings.restClient({
        oauthUrl: 'https://accounts.dev.allthings.me',
        apiUrl: 'https://api.dev.allthings.me',
        clientId: '575027e58178f56a008b4568_3t6ualb01m2o0gocgw40c48c0k000kgkk8oss4oooss8o8ogsw',
        clientSecret: '3l0kckn2q5ogcs0w4o4oosc8g44gcog0c8o0gwkoo0gcwgg88o'
      })

      const user = await client.getCurrentUser()



      document.getElementById('app').innerHTML =
        `<div>Hi there, ${user.username} (${user.email})</div>`

      const checkMe = async () => {
        const user = await client.getCurrentUser()

        console.log(user)
      }
    })
  </script>
        <button onClick="checkMe()">
          click me
          </button>
</body>

</html>
